(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}})();const v=r=>/^https?:\/\//i.test(r.trim()),m=r=>r.split(",").map(t=>t.trim()).filter(t=>t.length>0),R=/^[A-Za-z ]+$/;function U(r){const t=r.trim();if(t===""||t==='"*"'||t==="*")return{keywords:[]};if(!R.test(t)){const n=[...t].findIndex(s=>!/[A-Za-z ]/.test(s)),e=n>=0?t[n]:"?";return{keywords:[],error:`7열 search keyword에 알파벳/공백 외 문자 발견: '${e}'`}}return{keywords:m(t.toLowerCase())}}function I(r){return!r||r.trim()===""||r.trim()==="*"||r.trim()==='"*"'?[""]:m(r).map(t=>t.replace(/[^0-9]/g,"")).filter(t=>t.length>0)}function j(r){const t=r.trim();return!t||t===""?[""]:t==="*"||t==='"*"'?["*"]:m(t).map(n=>{const e=n.replace(/[^0-9]/g,"");return e.length>0?e:n})}function A(r){const t=r.replace(/\r\n?/g,`
`).split(`
`).filter(s=>s.trim().length>0),o=[],n=[],e=[];return t.forEach((s,l)=>{const a=l+1,d=s.split("	").map(N=>N.trim());for(d.length<10&&n.push(`행 ${a}: 컬럼 수(${d.length})가 10보다 적음`);d.length<10;)d.push("");const[y,S,b,_,z,p,B,x,C,f]=d;y||n.push(`행 ${a}: title 비어있음`),p&&!v(p)&&n.push(`행 ${a}: description_src URL 형식 아님`),f&&!v(f)&&n.push(`행 ${a}: gmap_url URL 형식 아님`);const g=U(B);if(g.error){e.push(`행 ${a}: ${g.error}`);return}const O={title:y,region:S,nation:b,description:_,description_src:p,search_keywords:g.keywords,preferred_id:I(x),ignore_id:j(C),gmap_url:f};o.push(O)}),{ok:o,warnings:n,errors:e}}const i=r=>document.getElementById(r),$=i("input"),u=i("output"),M=i("status"),P=i("errorsWrap"),L=i("errors"),T=i("errCount"),H=i("convertBtn"),k=i("copyBtn"),E=i("downloadBtn"),J=i("clearBtn");function c(r){M.textContent=r}function h(r){k.disabled=!r,E.disabled=!r}function w(r,t){L.innerHTML="";const o=[...r.map(n=>({text:n,cls:"err"})),...t.map(n=>({text:n,cls:"warn"}))];for(const n of o){const e=document.createElement("li");e.textContent=n.text,L.appendChild(e)}T.textContent=String(o.length),P.open=o.length>0}H.addEventListener("click",()=>{const r=$.value,{ok:t,warnings:o,errors:n}=A(r),e=JSON.stringify(t,null,2);u.value=e,h(t.length>0),c(`성공 ${t.length}개 · 오류 ${n.length}개 · 경고 ${o.length}개`),w(n,o)});k.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(u.value),c("JSON이 클립보드에 복사되었습니다.")}catch{c("클립보드 복사 실패. 브라우저 권한을 확인하세요.")}});E.addEventListener("click",()=>{const r=new Blob([u.value],{type:"application/json;charset=utf-8"}),t=URL.createObjectURL(r),o=document.createElement("a"),n=new Date,e=`converted-${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}-${String(n.getHours()).padStart(2,"0")}${String(n.getMinutes()).padStart(2,"0")}.json`;o.href=t,o.download=e,o.click(),URL.revokeObjectURL(t),c("JSON 파일을 다운로드했습니다.")});J.addEventListener("click",()=>{$.value="",u.value="",h(!1),w([],[]),c("초기화됨")});h(!1);w([],[]);c("TSV를 붙여넣고 Convert를 누르세요. 7번째 컬럼은 알파벳/공백/쉼표만 허용");
